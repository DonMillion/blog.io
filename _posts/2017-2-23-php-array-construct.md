---
layout: post
title: php数组的内部结构简介
date: 2016-11-1
categories: blog
tags: [php原理]
description: php数组的内部结构。
---

## php数组的结构

php的数组内部结构是通过键值的哈希值寻找对应的槽位，每个槽位指向一个双向链表。

双向链表里的每一个元素都有对应的key值和上一个跟下一个元素的地址。找到槽位后，系统会沿着链表逐个匹配key值，如果相等则取之，找不到则返回null.这是php数组在寻位时的基本过程。

由于php的哈希算法是公开的，所以可以刻意制造出大量相同槽位的key，这样的话，系统匹配key值以及插入时会造成性能下降，可以参考作为一种DDOS攻击。这种攻击方式更容易出现在json_decode时出现。

每个元素都有一个指针指向下一个元素的地址，foreach语句这样在遍历的时候就利用了这个特点，遍历数组时速度比直接指明key值要快，因为前者不用重新计算元素地址。